<!DOCTYPE html>
<html lang="pl" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Głos Trójki - Portal Szkolny</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&family=Playfair+Display:wght@600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- ZMIENNE & MOTYWY --- */
        :root {
            --bg: #050505;
            --paper: #111111;
            --text-main: #ffffff;
            --text-muted: #aaaaaa;
            --accent: #ffd100;
            --accent-hover: #ffae00;
            --border: rgba(255,255,255,0.1);
            --shadow: 0 10px 30px rgba(0,0,0,0.5);
            --radius: 8px;
        }

        [data-theme="light"] {
            --bg: #f4f4f4;
            --paper: #ffffff;
            --text-main: #1a1a1a;
            --text-muted: #555555;
            --accent: #0056b3;
            --accent-hover: #004494;
            --border: rgba(0,0,0,0.1);
            --shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        * { box-sizing: border-box; transition: background 0.3s, color 0.3s, border-color 0.3s; }
        
        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text-main);
            overflow-x: hidden;
            padding-bottom: 50px;
        }

        a { text-decoration: none; color: inherit; }
        ul { list-style: none; padding: 0; margin: 0; }
        button { cursor: pointer; font-family: inherit; border: none; }

        /* --- ANIMACJE --- */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        
        .anim-entry { animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; opacity: 0; }
        .anim-delay-1 { animation-delay: 0.1s; }
        .anim-delay-2 { animation-delay: 0.2s; }
        .anim-delay-3 { animation-delay: 0.3s; }

        /* --- UI HELPERS --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        .btn {
            background: var(--accent);
            color: #000;
            padding: 10px 20px;
            font-weight: 700;
            border-radius: var(--radius);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        [data-theme="light"] .btn { color: #fff; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(255, 209, 0, 0.3); background: var(--accent-hover); }
        
        /* POPRAWKA: Badge ma teraz szerokość dopasowaną do tekstu */
        .badge {
            background: var(--accent); color: #000; padding: 6px 12px;
            border-radius: 4px; font-size: 0.75rem; font-weight: 800; text-transform: uppercase;
            width: fit-content; display: inline-block;
        }
        [data-theme="light"] .badge { color: #fff; }

        /* --- HEADER --- */
        .top-bar { background: var(--paper); border-bottom: 1px solid var(--border); padding: 8px 0; font-size: 0.85rem; color: var(--text-muted); }
        .top-bar .container { display: flex; justify-content: space-between; align-items: center; }
        .settings-panel { display: flex; gap: 15px; align-items: center; }
        
        header { padding: 30px 0; border-bottom: 1px solid var(--border); }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        
        /* POPRAWKA: Podkreślenie Logo i usunięcie kropki */
        .logo-area h1 { 
            font-family: 'Playfair Display', serif; font-size: 3.5rem; margin: 0; line-height: 1; letter-spacing: -2px; 
            display: inline-block;
            position: relative;
        }
        .logo-area h1::after {
            content: '';
            display: block;
            width: 100%;
            height: 8px;
            background: var(--accent);
            margin-top: 5px;
            border-radius: 2px;
        }

        .logo-area .subtitle { color: var(--accent); font-style: italic; font-weight: 500; margin-top: 10px; display: block; }
        
        .user-avatar { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--accent); object-fit: cover; cursor: pointer; transition: transform 0.2s; }
        .user-avatar:hover { transform: scale(1.1); }

        /* --- NAVIGATION & SEARCH --- */
        .main-nav { background: var(--paper); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid var(--border); box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .nav-container { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; max-width: 1200px; margin: 0 auto; }
        .nav-list { display: flex; gap: 25px; font-weight: 600; font-size: 0.95rem; }
        .nav-list a { position: relative; padding: 10px 0; }
        .nav-list a::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0%; height: 2px; background: var(--accent); transition: 0.3s; }
        .nav-list a:hover::after { width: 100%; }

        /* Improved Search Bar */
        .search-wrapper { position: relative; width: 250px; }
        .search-input-group {
            display: flex; align-items: center;
            background: var(--bg); border: 1px solid var(--border);
            border-radius: 20px; padding: 5px 15px;
            transition: border-color 0.3s, width 0.3s;
        }
        .search-input-group:focus-within { border-color: var(--accent); box-shadow: 0 0 10px rgba(255, 209, 0, 0.1); }
        .search-input-group input {
            background: transparent; border: none; color: var(--text-main);
            width: 100%; outline: none; padding: 5px;
        }
        .search-input-group i { color: var(--text-muted); cursor: pointer; }
        
        .search-suggestions {
            position: absolute; top: 120%; left: 0; width: 100%;
            background: var(--paper); border: 1px solid var(--border);
            border-radius: 8px; z-index: 101; display: none;
            box-shadow: var(--shadow); overflow: hidden;
        }
        .suggestion-item {
            padding: 10px 15px; cursor: pointer; border-bottom: 1px solid var(--border);
            font-size: 0.9rem; display: flex; align-items: center; gap: 10px;
        }
        .suggestion-item:hover { background: rgba(255,255,255,0.05); color: var(--accent); }
        .suggestion-item img { width: 30px; height: 30px; border-radius: 4px; object-fit: cover; }

        /* --- TICKER --- */
        .news-ticker { background: var(--accent); color: #000; padding: 8px 0; overflow: hidden; white-space: nowrap; font-weight: 700; font-size: 0.9rem; }
        [data-theme="light"] .news-ticker { color: #fff; }
        .ticker-content { display: inline-block; animation: marquee 20s linear infinite; }
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* --- LAYOUT --- */
        .main-grid { display: grid; grid-template-columns: 2.5fr 1fr; gap: 40px; margin-top: 40px; }

        /* --- CARDS --- */
        .articles-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .card {
            background: var(--paper); border: 1px solid var(--border); border-radius: var(--radius);
            overflow: hidden; display: flex; flex-direction: column; transition: 0.3s; cursor: pointer;
            position: relative;
        }
        .card:hover { transform: translateY(-8px); box-shadow: var(--shadow); border-color: var(--accent); }
        .card-img-wrap { overflow: hidden; height: 180px; position: relative; }
        .card-img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; }
        .card:hover .card-img { transform: scale(1.1); }
        .card-body { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; }
        .card-meta { font-size: 0.75rem; color: var(--accent); font-weight: 700; margin-bottom: 8px; display: flex; justify-content: space-between; text-transform: uppercase; }
        .card-title { font-weight: 700; font-size: 1.1rem; margin: 0 0 10px; line-height: 1.4; }
        .card-time { font-size: 0.8rem; color: var(--text-muted); margin-top: auto; padding-top: 10px; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        
        .like-btn { cursor: pointer; transition: 0.2s; font-size: 1.1rem; display: flex; align-items: center; gap: 5px; }
        .like-btn:hover { transform: scale(1.1); }
        .like-btn.liked { color: #ff4757; animation: popIn 0.3s; }
        .like-count { font-size: 0.8rem; font-weight: 600; }

        /* --- SIDEBAR WIDGETS --- */
        .sidebar-widget { background: var(--paper); padding: 25px; border-radius: var(--radius); margin-bottom: 30px; border: 1px solid var(--border); animation: slideUp 0.8s ease backwards; }
        .widget-title { font-size: 1.2rem; font-weight: 800; margin-bottom: 15px; border-left: 4px solid var(--accent); padding-left: 10px; text-transform: uppercase; }
        .event-list li { display: flex; gap: 15px; margin-bottom: 15px; align-items: center; cursor: pointer; transition: transform 0.2s; }
        .event-list li:hover { transform: translateX(5px); }
        .event-date { background: var(--bg); padding: 8px 12px; border-radius: 6px; text-align: center; border: 1px solid var(--border); }
        .event-date b { display: block; font-size: 1.2rem; color: var(--accent); }

        /* --- READER MODAL (FULLSCREEN) --- */
        .reader-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000;
            display: none; justify-content: center; overflow-y: auto; padding: 40px 20px;
            backdrop-filter: blur(8px); animation: fadeIn 0.3s;
        }
        .reader-content {
            background: var(--paper); width: 100%; max-width: 800px; border-radius: 12px;
            padding: 40px; position: relative; box-shadow: var(--shadow);
            border: 1px solid var(--border); animation: slideUp 0.4s;
            height: fit-content; margin-bottom: 50px;
        }
        .reader-close {
            position: absolute; top: 20px; right: 20px; font-size: 2rem;
            background: none; color: var(--text-muted); transition: 0.3s;
        }
        .reader-close:hover { color: var(--accent); transform: rotate(90deg); }
        .reader-img { width: 100%; height: 400px; object-fit: cover; border-radius: 8px; margin-bottom: 20px; }
        .reader-meta { display: flex; gap: 20px; color: var(--accent); font-weight: bold; margin-bottom: 15px; font-size: 0.9rem; }
        .reader-body { line-height: 1.8; font-size: 1.1rem; color: var(--text-muted); min-height: 200px; }

        /* --- LOGIN & SETTINGS MODALS --- */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 3000;
            display: none; justify-content: center; align-items: center;
        }
        .modal {
            background: var(--paper); width: 100%; max-width: 400px; padding: 30px;
            border-radius: 12px; border: 1px solid var(--accent); position: relative;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .form-group { margin-bottom: 15px; }
        .form-group input { width: 100%; padding: 12px; border-radius: 6px; border: 1px solid var(--border); background: var(--bg); color: var(--text-main); }
        
        .avatars-grid { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin: 15px 0; }
        .avatar-opt { width: 50px; height: 50px; border-radius: 50%; border: 3px solid transparent; cursor: pointer; opacity: 0.6; transition: 0.2s; }
        .avatar-opt:hover { opacity: 1; }
        .avatar-opt.active { border-color: var(--accent); opacity: 1; transform: scale(1.15); }

        /* Responsive */
        @media (max-width: 768px) {
            .main-grid { grid-template-columns: 1fr; }
            .header-content { flex-direction: column; text-align: center; gap: 15px; }
            .nav-list { display: none; } /* Mobile menu simplified */
            .search-wrapper { width: 100%; }
            .logo-area h1 { font-size: 2.5rem; }
        }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="container">
            <div id="date-display">Ładowanie daty...</div>
            <div class="settings-panel">
                <div class="lang-switch">PL | EN | UA</div>
                <div style="cursor: pointer;" onclick="toggleTheme()"><i class="fas fa-moon"></i></div>
            </div>
        </div>
    </div>

    <header>
        <div class="container header-content">
            <div class="logo-area anim-entry">
                <h1>Głos Trójki</h1>
                <span class="subtitle">Nasza szkoła na bieżąco!</span>
            </div>
            
            <div class="anim-entry anim-delay-1" id="userArea">
                </div>
        </div>
    </header>

    <nav class="main-nav anim-entry anim-delay-2">
        <div class="nav-container">
            <ul class="nav-list">
                <li><a href="https://glostrojki.github.io/home">Strona Główna</a></li>
                <li><a href="https://glostrojki.github.io/home/informacje">Informacje</a></li>
                <li><a href="https://glostrojki.github.io/home/wydarzenia">Wydarzenia</a></li>
                <li><a href="https://glostrojki.github.io/home/redakcja">Redakcja</a></li>
            </ul>
            
            <div class="search-wrapper">
                <div class="search-input-group">
                    <input type="text" id="searchInput" placeholder="Szukaj..." autocomplete="off">
                    <i class="fas fa-search" onclick="toggleSearch()" style="cursor:pointer"></i>
                </div>
                <div class="search-suggestions" id="suggestionsBox"></div>
            </div>
        </div>
    </nav>

    <div class="news-ticker">
        <div class="ticker-content">
            <i class="fas fa-fire"></i> WAŻNE: Strona w fazie testów beta &nbsp;&bull;&nbsp; Zapisy na konkursy trwają &nbsp;&bull;&nbsp; Sprawdź nowy plan lekcji
        </div>
    </div>

    <main class="container main-grid">
        
        <section>
            <div class="card anim-entry anim-delay-3" style="margin-bottom: 40px;" onclick="openArticle(0)">
                <div class="card-img-wrap" style="height: 350px;">
                    <img src="https://imgur.com/9G2vFjB.png" class="card-img">
                </div>
                <div class="card-body" style="position: absolute; bottom: 0; background: linear-gradient(to top, rgba(0,0,0,0.95), transparent); width: 100%; color: #fff;">
                    <span class="badge">Wyróżnione</span>
                    <h2 style="font-family: 'Playfair Display'; font-size: 2.2rem; margin: 10px 0;">Nowa strona internetowa już gotowa!</h2>
                    <p>Kliknij, aby przeczytać o zmianach...</p>
                </div>
            </div>

            <h3 class="anim-entry" style="border-bottom: 2px solid var(--accent); display: inline-block; padding-bottom: 5px;">Najnowsze Wiadomości</h3>
            
            <div class="articles-grid" id="articlesList"></div>

        </section>

        <aside class="sidebar">
            <div class="sidebar-widget weather-widget">
                <div class="widget-title">Pogoda</div>
                <div id="weatherData" style="text-align: center;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i>
                    <p>Ładowanie pogody...</p>
                </div>
            </div>

            <div class="sidebar-widget">
                <div class="widget-title">Kalendarz</div>
                <ul class="event-list">
                    <li><div class="event-date"><b>14</b>STY</div> <div>Zebranie Rady</div></li>
                    <li><div class="event-date"><b>20</b>STY</div> <div>Dzień Patrona</div></li>
                    <li><div class="event-date"><b>24</b>LUT</div> <div>Bal Karnawałowy</div></li>
                </ul>
            </div>
        </aside>

    </main>

    <footer style="text-align: center; padding: 40px; margin-top: 50px; border-top: 1px solid var(--border); color: var(--text-muted);">
        &copy; 2026 Głos Trójki. Wszystkie prawa zastrzeżone.
    </footer>

    <div class="reader-overlay" id="readerOverlay">
        <div class="reader-content" id="readerContent">
            <button class="reader-close" onclick="closeReader()">×</button>
            <div id="readerInject"></div>
        </div>
    </div>

    <div class="modal-overlay" id="authModal">
        <div class="modal" id="loginForm">
            <button style="position:absolute; top:10px; right:10px;" onclick="closeModals()">×</button>
            <h2>Zaloguj się</h2>
            <div class="form-group"><input type="text" id="loginNick" placeholder="Twój Nick"></div>
            <button class="btn" style="width:100%" onclick="login()">Wchodzę!</button>
        </div>

        <div class="modal" id="settingsForm" style="display:none">
            <button style="position:absolute; top:10px; right:10px;" onclick="closeModals()">×</button>
            <h2>Ustawienia Konta</h2>
            <p>Zmień awatar:</p>
            <div class="avatars-grid" id="avatarList"></div>
            <button class="btn" style="width:100%" onclick="saveSettings()">Zapisz zmiany</button>
            <button class="btn" style="width:100%; background: #333; margin-top: 10px;" onclick="logout()">Wyloguj się</button>
        </div>
    </div>

    <script>
        // --- 7 GOTOWYCH ARTYKUŁÓW (Bez treści - do uzupełnienia) ---
        const articlesData = [
            {
                id: 0,
                title: "Nowa strona internetowa już gotowa!",
                category: "SZKOŁA",
                date: "2026-01-12T10:00:00", 
                img: "https://imgur.com/9G2vFjB.png",
                content: "Witamy na nowej stronie! Wkrótce pojawi się tutaj pełen opis wszystkich funkcjonalności.",
                baseLikes: 7
            },
            {
                id: 1,
                title: "Świąteczny konkurs 2025 - Wyniki",
                category: "REDAKCJA",
                date: "2026-01-12T17:00:00", 
                img: "https://imgur.com/jKoxmfY.png",
                content: "Treść artykułu do uzupełnienia...",
                baseLikes: 5
            },
            {
                id: 2,
                title: "Jak zrobić Pantograf? Kącik ZRÓB TO SAM",
                category: "TECHNIKA",
                date: "2026-01-11T14:30:00",
                img: "https://imgur.com/CuMg6rr.png",
                content: "Treść artykułu do uzupełnienia...",
                baseLikes: 3
            },
            {
                id: 3,
                title: "Napisz artykuł do gazetki!",
                category: "REKRUTACJA",
                date: "2025-12-20T09:00:00",
                img: "https://via.placeholder.com/400x250/333/fff?text=Redakcja",
                content: "Treść artykułu do uzupełnienia...",
                baseLikes: 4
            },
            {
                id: 4,
                title: "Turniej Szachowy - Zapisy",
                category: "SPORT",
                date: "2026-01-12T17:15:00",
                img: "https://via.placeholder.com/400x250/111/fd0?text=Szachy",
                content: "Treść artykułu do uzupełnienia...",
                baseLikes: 6
            },
            {
                id: 5,
                title: "Wywiad z Panią od Przyrody",
                category: "WYWIAD",
                date: "2026-01-10T08:00:00",
                img: "https://via.placeholder.com/400x250/224/fff?text=Wywiad",
                content: "Treść artykułu do uzupełnienia...",
                baseLikes: 7
            },
            {
                id: 6,
                title: "Dzień pizzy w naszej szkole",
                category: "WYDARZENIA",
                date: "2026-01-09T12:00:00",
                img: "https://via.placeholder.com/400x250/500/fff?text=Pizza",
                content: "Treść artykułu do uzupełnienia...",
                baseLikes: 4
            },
            {
                id: 7,
                title: "Nowe książki w bibliotece",
                category: "BIBLIOTEKA",
                date: "2026-01-08T10:00:00",
                img: "https://via.placeholder.com/400x250/003/fff?text=Książki",
                content: "Treść artykułu do uzupełnienia...",
                baseLikes: 5
            }
        ];

        // Dostępne awatary
        const avatars = [
            "https://imgur.com/eH7nUi9.png", "https://imgur.com/44R9rSV.png",
            "https://imgur.com/PPzo0Kq.png", "https://imgur.com/nTEKmmn.png",
            "https://imgur.com/k1vJTuJ.png"
        ];

        // --- POGODA (API OpenMeteo dla Sulejówka) ---
        async function fetchWeather() {
            try {
                // Współrzędne Sulejówka: 52.2177° N, 21.2831° E
                const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=52.2177&longitude=21.2831&current_weather=true');
                const data = await response.json();
                
                const temp = Math.round(data.current_weather.temperature);
                const code = data.current_weather.weathercode;
                
                let icon = 'fa-cloud';
                let desc = 'Pochmurno';

                // Proste mapowanie kodów WMO na ikony
                if(code === 0) { icon = 'fa-sun'; desc = 'Słonecznie'; }
                else if(code >= 1 && code <= 3) { icon = 'fa-cloud-sun'; desc = 'Lekkie zachmurzenie'; }
                else if(code >= 45 && code <= 48) { icon = 'fa-smog'; desc = 'Mgła'; }
                else if(code >= 51 && code <= 67) { icon = 'fa-cloud-rain'; desc = 'Deszcz'; }
                else if(code >= 71 && code <= 77) { icon = 'fa-snowflake'; desc = 'Śnieg'; }
                else if(code >= 95) { icon = 'fa-bolt'; desc = 'Burza'; }

                const weatherHTML = `
                    <i class="fas ${icon}" style="font-size: 3rem; color: var(--accent); margin-bottom:10px;"></i>
                    <h2 style="margin: 5px 0; font-size:2.5rem;">${temp}°C</h2>
                    <span style="color: var(--text-muted); font-weight:600">${desc}</span>
                    <div style="font-size:0.8rem; margin-top:5px; color:#666">Sulejówek</div>
                `;
                document.getElementById('weatherData').innerHTML = weatherHTML;
            } catch (error) {
                document.getElementById('weatherData').innerHTML = '<p>Błąd pogody :(</p>';
            }
        }

        // --- FUNKCJE CZASU ---
        function timeAgo(dateString) {
            const now = new Date();
            const past = new Date(dateString);
            const diffMs = now - past;
            const diffMin = Math.floor(diffMs / 1000 / 60);
            
            if (diffMin < 1) return "przed chwilą";
            if (diffMin < 60) return `${diffMin} min temu`;
            
            const diffHour = Math.floor(diffMin / 60);
            if (diffHour < 24) return diffHour === 1 ? "1 godzinę temu" : `${diffHour} godz. temu`;
            
            const diffDay = Math.floor(diffHour / 24);
            if (diffDay < 30) return diffDay === 1 ? "1 dzień temu" : `${diffDay} dni temu`;

            const diffMonth = Math.floor(diffDay / 30);
            if (diffMonth < 12) return diffMonth === 1 ? "1 miesiąc temu" : `${diffMonth} miesięcy temu`;

            const diffYear = Math.floor(diffDay / 365);
            return diffYear === 1 ? "1 rok temu" : `${diffYear} lat temu`;
        }

        // --- RENDEROWANIE ARTYKUŁÓW ---
        function renderArticles() {
            const container = document.getElementById('articlesList');
            container.innerHTML = "";
            
            // Pobieramy polubienia użytkownika z localStorage
            const userLikes = JSON.parse(localStorage.getItem('likes')) || {};

            // Sortowanie od najnowszych
            const sorted = [...articlesData].sort((a,b) => new Date(b.date) - new Date(a.date));

            sorted.forEach((art, index) => {
                if (art.id === 0) return; // Wyróżniony (Hero) jest renderowany osobno w HTML
                
                const isLiked = userLikes[art.id] ? true : false;
                const heartClass = isLiked ? 'fas' : 'far';
                const btnClass = isLiked ? 'liked' : '';
                
                // Liczba serc: baza z obiektu + 1 jeśli użytkownik polubił
                let displayLikes = art.baseLikes;
                if(isLiked) displayLikes += 1;

                const timeText = timeAgo(art.date);

                const html = `
                <div class="card anim-entry" style="animation-delay: ${index * 0.1}s">
                    <div class="card-img-wrap" onclick="openArticle(${art.id})">
                        <img src="${art.img}" class="card-img">
                    </div>
                    <div class="card-body">
                        <div class="card-meta">
                            <span>${art.category}</span>
                            <span>${timeText}</span>
                        </div>
                        <h3 class="card-title" onclick="openArticle(${art.id})">${art.title}</h3>
                        <div class="card-time">
                            <span onclick="openArticle(${art.id})" style="cursor:pointer; font-weight:600; color:var(--text-main)">Czytaj dalej...</span>
                            <div class="like-btn ${btnClass}" onclick="toggleLike(this, ${art.id})">
                                <i class="${heartClass} fa-heart"></i>
                                <span class="like-count">${displayLikes}</span>
                            </div>
                        </div>
                    </div>
                </div>
                `;
                container.innerHTML += html;
            });
        }

        // --- CZYTANIE ARTYKUŁU (READER) ---
        function openArticle(id) {
            const art = articlesData.find(a => a.id === id);
            if(!art) return;

            const inject = document.getElementById('readerInject');
            // POPRAWKA: Treść brana tylko z obiektu, brak Lorem Ipsum/Francuskiego
            inject.innerHTML = `
                <img src="${art.img}" class="reader-img">
                <div class="reader-meta">
                    <span>${art.category}</span>
                    <span>${new Date(art.date).toLocaleDateString('pl-PL')}</span>
                </div>
                <h1 style="font-family:'Playfair Display'; font-size:2.5rem; margin:0 0 20px;">${art.title}</h1>
                <div class="reader-body">
                    <p style="white-space: pre-wrap;">${art.content}</p>
                </div>
            `;
            document.getElementById('readerOverlay').style.display = 'flex';
        }

        function closeReader() {
            document.getElementById('readerOverlay').style.display = 'none';
        }

        // --- POLUBIENIA ---
        function toggleLike(btn, id) {
            let userLikes = JSON.parse(localStorage.getItem('likes')) || {};
            const icon = btn.querySelector('i');
            const countSpan = btn.querySelector('.like-count');
            let currentCount = parseInt(countSpan.innerText);
            
            if (userLikes[id]) {
                // Usuwamy lajka
                delete userLikes[id];
                btn.classList.remove('liked');
                icon.className = 'far fa-heart';
                countSpan.innerText = currentCount - 1;
            } else {
                // Dodajemy lajka
                userLikes[id] = true;
                btn.classList.add('liked');
                icon.className = 'fas fa-heart';
                countSpan.innerText = currentCount + 1;
            }
            localStorage.setItem('likes', JSON.stringify(userLikes));
        }

        // --- WYSZUKIWARKA ---
        const searchInput = document.getElementById('searchInput');
        const suggestionsBox = document.getElementById('suggestionsBox');

        searchInput.addEventListener('input', function() {
            const val = this.value.toLowerCase();
            suggestionsBox.innerHTML = '';
            
            if (val.length < 1) {
                suggestionsBox.style.display = 'none';
                renderArticles(); 
                return;
            }

            const matched = articlesData.filter(a => a.title.toLowerCase().includes(val));
            
            if(matched.length > 0) {
                suggestionsBox.style.display = 'block';
                matched.forEach(m => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    div.innerHTML = `<img src="${m.img}"> ${m.title}`;
                    div.onclick = () => {
                        openArticle(m.id);
                        suggestionsBox.style.display = 'none';
                        searchInput.value = '';
                    };
                    suggestionsBox.appendChild(div);
                });
            } else {
                suggestionsBox.style.display = 'none';
            }

            // Filtruj widok kart
            document.querySelectorAll('.card').forEach(card => {
                const title = card.querySelector('.card-title');
                if(title && !title.innerText.toLowerCase().includes(val)) {
                    card.style.display = 'none';
                } else {
                    card.style.display = 'flex';
                }
            });
        });

        // --- UŻYTKOWNIK I LOGOWANIE ---
        let tempAvatar = avatars[0];

        function checkUser() {
            const nick = localStorage.getItem('nick');
            const avatar = localStorage.getItem('avatar');
            const userArea = document.getElementById('userArea');

            if (nick) {
                userArea.innerHTML = `
                    <div style="display:flex; align-items:center; gap:10px;">
                        <div style="text-align:right">
                            <small style="color:var(--text-muted)">Witaj,</small>
                            <div style="font-weight:700">${nick}</div>
                        </div>
                        <img src="${avatar}" class="user-avatar" onclick="openSettings()">
                    </div>
                `;
            } else {
                userArea.innerHTML = `<button class="btn" onclick="openLogin()">Zaloguj się</button>`;
            }
        }

        function openLogin() {
            document.getElementById('authModal').style.display = 'flex';
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('settingsForm').style.display = 'none';
        }
        function openSettings() {
            document.getElementById('authModal').style.display = 'flex';
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('settingsForm').style.display = 'block';
            renderAvatarPicker();
        }
        function closeModals() { document.getElementById('authModal').style.display = 'none'; }

        function login() {
            const nick = document.getElementById('loginNick').value;
            if(!nick) return alert("Podaj nick!");
            localStorage.setItem('nick', nick);
            localStorage.setItem('avatar', avatars[Math.floor(Math.random()*avatars.length)]);
            closeModals();
            checkUser();
        }

        function renderAvatarPicker() {
            const list = document.getElementById('avatarList');
            list.innerHTML = '';
            const current = localStorage.getItem('avatar');
            avatars.forEach(url => {
                const img = document.createElement('img');
                img.src = url;
                img.className = 'avatar-opt ' + (url === current ? 'active' : '');
                img.onclick = () => {
                    tempAvatar = url;
                    document.querySelectorAll('.avatar-opt').forEach(el => el.classList.remove('active'));
                    img.classList.add('active');
                };
                list.appendChild(img);
            });
        }

        function saveSettings() {
            if(tempAvatar) localStorage.setItem('avatar', tempAvatar);
            closeModals();
            checkUser();
        }

        function logout() {
            localStorage.clear();
            location.reload();
        }

        function toggleTheme() {
            const html = document.documentElement;
            html.setAttribute('data-theme', html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
        }

        // --- INICJALIZACJA ---
        const d = new Date();
        const days = ["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"];
        const months = ["Stycznia","Lutego","Marca","Kwietnia","Maja","Czerwca","Lipca","Sierpnia","Września","Października","Listopada","Grudnia"];
        document.getElementById('date-display').innerText = `${days[d.getDay()]}, ${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;

        renderArticles();
        checkUser();
        fetchWeather(); // Pobranie pogody dla Sulejówka
        
        setInterval(renderArticles, 60000); // Odświeżanie czasów co minutę

    </script>
</body>
</html>
